<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf8" />
<title>Class: TapOut::Reporters::Abstract</title>
<link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (A)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../TapOut.html" title="TapOut (module)">TapOut</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Reporters.html" title="TapOut::Reporters (module)">Reporters</a></span></span>
     &raquo; 
    <span class="title">Abstract</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: TapOut::Reporters::Abstract
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">TapOut::Reporters::Abstract</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/tapout/reporters/abstract.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>The Abstract class serves as a base class for all reporters. Reporters must
sublcass Abstract in order to be added the the Reporters Index.</p>

<p>TODO: Simplify this class and have the sublcasses handle more of the load.</p>


  </div>
</div>
<div class="tags">
  
</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="Breakdown.html" title="TapOut::Reporters::Breakdown (class)">Breakdown</a></span>, <span class='object_link'><a href="Dotprogress.html" title="TapOut::Reporters::Dotprogress (class)">Dotprogress</a></span>, <span class='object_link'><a href="Progressbar.html" title="TapOut::Reporters::Progressbar (class)">Progressbar</a></span>, <span class='object_link'><a href="Tap.html" title="TapOut::Reporters::Tap (class)">Tap</a></span>, <span class='object_link'><a href="Verbose.html" title="TapOut::Reporters::Verbose (class)">Verbose</a></span></p>
</div>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="INTERNALS-constant" class="">INTERNALS =
          
        </dt>
        <dd><pre class="code"><span class='dregexp node'>/(lib|bin)#{Regexp.escape(File::SEPARATOR)}ko/</span>
</pre></dd>
      
    </dl>
  



  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inherited-class_method" title="inherited (class method)">+ (Object) <strong>inherited</strong>(subclass) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>When Abstract is inherited it saves a reference to it in `Reporters.index`.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#%3C%3C-instance_method" title="#&lt;&lt; (instance method)">- (Object) <strong>&lt;&lt;</strong>(entry) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clean_backtrace-instance_method" title="#clean_backtrace (instance method)">- (Object) <strong>clean_backtrace</strong>(backtrace) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Clean the backtrace of any reference to ko/ paths and code.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#code_snippet-instance_method" title="#code_snippet (instance method)">- (Object) <strong>code_snippet</strong>(entry) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a String of source code.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#err-instance_method" title="#err (instance method)">- (Object) <strong>err</strong>(entry) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Handle test with error status.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fail-instance_method" title="#fail (instance method)">- (Object) <strong>fail</strong>(entry) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Handle test with fail status.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#finish_case-instance_method" title="#finish_case (instance method)">- (Object) <strong>finish_case</strong>(entry) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>When a test case is complete.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#finish_suite-instance_method" title="#finish_suite (instance method)">- (Object) <strong>finish_suite</strong>(entry) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Handle footer.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#handle-instance_method" title="#handle (instance method)">- (Object) <strong>handle</strong>(entry) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Handler method.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Abstract) <strong>initialize</strong> </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>New reporter.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#note-instance_method" title="#note (instance method)">- (Object) <strong>note</strong>(entry) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Handle an arbitray note.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#omit-instance_method" title="#omit (instance method)">- (Object) <strong>omit</strong>(entry) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Handle test with omit status.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse_source_location-instance_method" title="#parse_source_location (instance method)">- (Object) <strong>parse_source_location</strong>(caller) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Parse source location from caller, caller[0] or an Exception object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#pass-instance_method" title="#pass (instance method)">- (Object) <strong>pass</strong>(entry) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Handle test with pass status.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#skip-instance_method" title="#skip (instance method)">- (Object) <strong>skip</strong>(entry) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Handle test with skip or pending status.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#source-instance_method" title="#source (instance method)">- (Object) <strong>source</strong>(file) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Cache source file text.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#start_case-instance_method" title="#start_case (instance method)">- (Object) <strong>start_case</strong>(entry) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>At the start of a new test case.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#start_suite-instance_method" title="#start_suite (instance method)">- (Object) <strong>start_suite</strong>(entry) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Handle header.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tally-instance_method" title="#tally (instance method)">- (Object) <strong>tally</strong>(entry) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>TODO: get the tally’s from the footer entry ?.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test-instance_method" title="#test (instance method)">- (Object) <strong>test</strong>(entry) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Handle test.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="TapOut::Reporters::Abstract (class)">Abstract</a></span></tt>) <strong>initialize</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>New reporter.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


32
33
34
35
36
37
38
39
40
41</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 32</span>

<span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span>
  <span class='@passed ivar id'>@passed</span>  <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='@failed ivar id'>@failed</span>  <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='@raised ivar id'>@raised</span>  <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='@skipped ivar id'>@skipped</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='@omitted ivar id'>@omitted</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>

  <span class='@source ivar id'>@source</span>  <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='@previous_case ivar id'>@previous_case</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="inherited-class_method">
  
    + (<tt>Object</tt>) <strong>inherited</strong>(subclass) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>When Abstract is inherited it saves a reference to it in `Reporters.index`.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28
29</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 26</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='inherited identifier id'>inherited</span><span class='lparen token'>(</span><span class='subclass identifier id'>subclass</span><span class='rparen token'>)</span>
  <span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='subclass identifier id'>subclass</span><span class='dot token'>.</span><span class='name identifier id'>name</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>'::'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='last identifier id'>last</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span>
  <span class='Reporters constant id'>Reporters</span><span class='dot token'>.</span><span class='index identifier id'>index</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='subclass identifier id'>subclass</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="<<-instance_method">
  
    - (<tt>Object</tt>) <strong>&lt;&lt;</strong>(entry) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


44
45
46</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 44</span>

<span class='def def kw'>def</span> <span class='lshft op'>&lt;&lt;</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
  <span class='handle identifier id'>handle</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="clean_backtrace-instance_method">
  
    - (<tt>Object</tt>) <strong>clean_backtrace</strong>(backtrace) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Clean the backtrace of any reference to ko/ paths and code.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


171
172
173
174
175
176
177
178
179
180
181
182
183</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 171</span>

<span class='def def kw'>def</span> <span class='clean_backtrace identifier id'>clean_backtrace</span><span class='lparen token'>(</span><span class='backtrace identifier id'>backtrace</span><span class='rparen token'>)</span>
  <span class='trace identifier id'>trace</span> <span class='assign token'>=</span> <span class='backtrace identifier id'>backtrace</span><span class='dot token'>.</span><span class='reject identifier id'>reject</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='bt identifier id'>bt</span><span class='bitor op'>|</span> <span class='bt identifier id'>bt</span> <span class='match op'>=~</span> <span class='INTERNALS constant id'>INTERNALS</span> <span class='rbrace token'>}</span>
  <span class='trace identifier id'>trace</span> <span class='assign token'>=</span> <span class='trace identifier id'>trace</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='bt identifier id'>bt</span><span class='bitor op'>|</span> 
    <span class='if if kw'>if</span> <span class='i identifier id'>i</span> <span class='assign token'>=</span> <span class='bt identifier id'>bt</span><span class='dot token'>.</span><span class='index identifier id'>index</span><span class='lparen token'>(</span><span class='string val'>':in'</span><span class='rparen token'>)</span>
      <span class='bt identifier id'>bt</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='dot3 op'>...</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span>
    <span class='else else kw'>else</span>
      <span class='bt identifier id'>bt</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='trace identifier id'>trace</span> <span class='assign token'>=</span> <span class='backtrace identifier id'>backtrace</span> <span class='if if_mod kw'>if</span> <span class='trace identifier id'>trace</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
  <span class='trace identifier id'>trace</span> <span class='assign token'>=</span> <span class='trace identifier id'>trace</span><span class='dot token'>.</span><span class='map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='bt identifier id'>bt</span><span class='bitor op'>|</span> <span class='bt identifier id'>bt</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='Dir constant id'>Dir</span><span class='dot token'>.</span><span class='pwd identifier id'>pwd</span><span class='plus op'>+</span><span class='File constant id'>File</span><span class='colon2 op'>::</span><span class='SEPARATOR constant id'>SEPARATOR</span><span class='comma token'>,</span><span class='string val'>''</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='trace identifier id'>trace</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="code_snippet-instance_method">
  
    - (<tt>Object</tt>) <strong>code_snippet</strong>(entry) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns a String of source code.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 186</span>

<span class='def def kw'>def</span> <span class='code_snippet identifier id'>code_snippet</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
  <span class='file identifier id'>file</span>    <span class='assign token'>=</span> <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'file'</span><span class='rbrack token'>]</span>
  <span class='line identifier id'>line</span>    <span class='assign token'>=</span> <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'line'</span><span class='rbrack token'>]</span>
  <span class='snippet identifier id'>snippet</span> <span class='assign token'>=</span> <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'snippet'</span><span class='rbrack token'>]</span>

  <span class='s identifier id'>s</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>

  <span class='case case kw'>case</span> <span class='snippet identifier id'>snippet</span>
  <span class='when when kw'>when</span> <span class='String constant id'>String</span>
    <span class='lines identifier id'>lines</span> <span class='assign token'>=</span> <span class='snippet identifier id'>snippet</span><span class='dot token'>.</span><span class='lines identifier id'>lines</span><span class='dot token'>.</span><span class='to_a identifier id'>to_a</span>
    <span class='index identifier id'>index</span> <span class='assign token'>=</span> <span class='line identifier id'>line</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='lines identifier id'>lines</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='div op'>/</span> <span class='integer val'>2</span><span class='rparen token'>)</span>
    <span class='lines identifier id'>lines</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='line identifier id'>line</span><span class='bitor op'>|</span>
      <span class='s identifier id'>s</span> <span class='lshft op'>&lt;&lt;</span> <span class='lbrack token'>[</span><span class='index identifier id'>index</span><span class='comma token'>,</span> <span class='line identifier id'>line</span><span class='rbrack token'>]</span>
      <span class='index identifier id'>index</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
    <span class='end end kw'>end</span>
  <span class='when when kw'>when</span> <span class='Array constant id'>Array</span>
    <span class='snippet identifier id'>snippet</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='h identifier id'>h</span><span class='bitor op'>|</span>
      <span class='s identifier id'>s</span> <span class='lshft op'>&lt;&lt;</span> <span class='lbrack token'>[</span><span class='h identifier id'>h</span><span class='dot token'>.</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='h identifier id'>h</span><span class='dot token'>.</span><span class='value identifier id'>value</span><span class='rbrack token'>]</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='comment val'>##backtrace = exception.backtrace.reject{ |bt| bt =~ INTERNALS }</span>
    <span class='comment val'>##backtrace.first =~ /(.+?):(\d+(?=:|\z))/ or return &quot;&quot;</span>
    <span class='comment val'>#caller =~ /(.+?):(\d+(?=:|\z))/ or return &quot;&quot;</span>
    <span class='comment val'>#source_file, source_line = $1, $2.to_i</span>

    <span class='if if kw'>if</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span>
      <span class='source identifier id'>source</span> <span class='assign token'>=</span> <span class='source identifier id'>source</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span>

      <span class='radius identifier id'>radius</span> <span class='assign token'>=</span> <span class='integer val'>3</span> <span class='comment val'># number of surrounding lines to show</span>
      <span class='region identifier id'>region</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='source_line identifier id'>source_line</span> <span class='minus op'>-</span> <span class='radius identifier id'>radius</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='max identifier id'>max</span> <span class='dot2 op'>..</span>
               <span class='lbrack token'>[</span><span class='source_line identifier id'>source_line</span> <span class='plus op'>+</span> <span class='radius identifier id'>radius</span><span class='comma token'>,</span> <span class='source identifier id'>source</span><span class='dot token'>.</span><span class='length identifier id'>length</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='min identifier id'>min</span>

      <span class='comment val'>#len = region.last.to_s.length</span>

      <span class='s identifier id'>s</span> <span class='assign token'>=</span> <span class='region identifier id'>region</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='n identifier id'>n</span><span class='bitor op'>|</span>
        <span class='format identifier id'>format</span> <span class='mod op'>%</span> <span class='lbrack token'>[</span><span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='source identifier id'>source</span><span class='lbrack token'>[</span><span class='n identifier id'>n</span><span class='minus op'>-</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='chomp identifier id'>chomp</span><span class='rbrack token'>]</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='len identifier id'>len</span> <span class='assign token'>=</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='comma token'>,</span><span class='t identifier id'>t</span><span class='rparen token'>)</span><span class='bitor op'>|</span> <span class='n identifier id'>n</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='max identifier id'>max</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='length identifier id'>length</span>

  <span class='comment val'># ensure proper alignment by zero-padding line numbers</span>
  <span class='format identifier id'>format</span> <span class='assign token'>=</span> <span class='dstring node'>&quot; %5s %0#{len}d %s&quot;</span>

  <span class='comment val'>#s = s.map{|n,t|[n,t]}.sort{|a,b|a[0]&lt;=&gt;b[0]}</span>

  <span class='pretty identifier id'>pretty</span> <span class='assign token'>=</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='comma token'>,</span><span class='t identifier id'>t</span><span class='rparen token'>)</span><span class='bitor op'>|</span>
    <span class='format identifier id'>format</span> <span class='mod op'>%</span> <span class='lbrack token'>[</span><span class='lparen token'>(</span><span class='string val'>'=&gt;'</span> <span class='if if_mod kw'>if</span> <span class='n identifier id'>n</span> <span class='eq op'>==</span> <span class='line identifier id'>line</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='t identifier id'>t</span><span class='dot token'>.</span><span class='rstrip identifier id'>rstrip</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span> <span class='comment val'>#.unshift &quot;[#{region.inspect}] in #{source_file}&quot;</span>

  <span class='return return kw'>return</span> <span class='pretty identifier id'>pretty</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="err-instance_method">
  
    - (<tt>Object</tt>) <strong>err</strong>(entry) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Handle test with error status.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


107
108
109</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 107</span>

<span class='def def kw'>def</span> <span class='err identifier id'>err</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
  <span class='@raised ivar id'>@raised</span> <span class='lshft op'>&lt;&lt;</span> <span class='entry identifier id'>entry</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="fail-instance_method">
  
    - (<tt>Object</tt>) <strong>fail</strong>(entry) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Handle test with fail status.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


102
103
104</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 102</span>

<span class='def def kw'>def</span> <span class='fail identifier id'>fail</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
  <span class='@failed ivar id'>@failed</span> <span class='lshft op'>&lt;&lt;</span> <span class='entry identifier id'>entry</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="finish_case-instance_method">
  
    - (<tt>Object</tt>) <strong>finish_case</strong>(entry) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>When a test case is complete.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


122
123</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 122</span>

<span class='def def kw'>def</span> <span class='finish_case identifier id'>finish_case</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="finish_suite-instance_method">
  
    - (<tt>Object</tt>) <strong>finish_suite</strong>(entry) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Handle footer.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126
127</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 126</span>

<span class='def def kw'>def</span> <span class='finish_suite identifier id'>finish_suite</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="handle-instance_method">
  
    - (<tt>Object</tt>) <strong>handle</strong>(entry) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Handler method. This dispatches a given entry to the appropriate report
methods.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 50</span>

<span class='def def kw'>def</span> <span class='handle identifier id'>handle</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
  <span class='case case kw'>case</span> <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'type'</span><span class='rbrack token'>]</span>
  <span class='when when kw'>when</span> <span class='string val'>'header'</span>
    <span class='start_suite identifier id'>start_suite</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='string val'>'case'</span>
    <span class='finish_case identifier id'>finish_case</span><span class='lparen token'>(</span><span class='@previous_case ivar id'>@previous_case</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='@previous_case ivar id'>@previous_case</span>
    <span class='@previous_case ivar id'>@previous_case</span> <span class='assign token'>=</span> <span class='entry identifier id'>entry</span>
    <span class='start_case identifier id'>start_case</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='string val'>'note'</span>
    <span class='note identifier id'>note</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='string val'>'test'</span>
    <span class='test identifier id'>test</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'status'</span><span class='rbrack token'>]</span>
    <span class='when when kw'>when</span> <span class='string val'>'pass'</span>
      <span class='pass identifier id'>pass</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'fail'</span>
      <span class='fail identifier id'>fail</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'error'</span>
      <span class='err identifier id'>err</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'omit'</span>
      <span class='omit identifier id'>omit</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'pending'</span><span class='comma token'>,</span> <span class='string val'>'skip'</span>
      <span class='skip identifier id'>skip</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='when when kw'>when</span> <span class='string val'>'footer'</span>
    <span class='finish_case identifier id'>finish_case</span><span class='lparen token'>(</span><span class='@previous_case ivar id'>@previous_case</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='@previous_case ivar id'>@previous_case</span>
    <span class='finish_suite identifier id'>finish_suite</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="note-instance_method">
  
    - (<tt>Object</tt>) <strong>note</strong>(entry) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Handle an arbitray note.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


89
90</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 89</span>

<span class='def def kw'>def</span> <span class='note identifier id'>note</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="omit-instance_method">
  
    - (<tt>Object</tt>) <strong>omit</strong>(entry) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Handle test with omit status.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


112
113
114</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 112</span>

<span class='def def kw'>def</span> <span class='omit identifier id'>omit</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
  <span class='@omitted ivar id'>@omitted</span> <span class='lshft op'>&lt;&lt;</span> <span class='entry identifier id'>entry</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="parse_source_location-instance_method">
  
    - (<tt>Object</tt>) <strong>parse_source_location</strong>(caller) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Parse source location from caller, caller[0] or an Exception object.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


249
250
251
252
253
254
255
256
257
258
259
260</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 249</span>

<span class='def def kw'>def</span> <span class='parse_source_location identifier id'>parse_source_location</span><span class='lparen token'>(</span><span class='caller identifier id'>caller</span><span class='rparen token'>)</span>
  <span class='case case kw'>case</span> <span class='caller identifier id'>caller</span>
  <span class='when when kw'>when</span> <span class='Exception constant id'>Exception</span>
    <span class='trace identifier id'>trace</span>  <span class='assign token'>=</span> <span class='caller identifier id'>caller</span><span class='dot token'>.</span><span class='backtrace identifier id'>backtrace</span><span class='dot token'>.</span><span class='reject identifier id'>reject</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='bt identifier id'>bt</span><span class='bitor op'>|</span> <span class='bt identifier id'>bt</span> <span class='match op'>=~</span> <span class='INTERNALS constant id'>INTERNALS</span> <span class='rbrace token'>}</span>
    <span class='caller identifier id'>caller</span> <span class='assign token'>=</span> <span class='trace identifier id'>trace</span><span class='dot token'>.</span><span class='first identifier id'>first</span>
  <span class='when when kw'>when</span> <span class='Array constant id'>Array</span>
    <span class='caller identifier id'>caller</span> <span class='assign token'>=</span> <span class='caller identifier id'>caller</span><span class='dot token'>.</span><span class='first identifier id'>first</span>
  <span class='end end kw'>end</span>
  <span class='caller identifier id'>caller</span> <span class='match op'>=~</span> <span class='regexp val'>/(.+?):(\d+(?=:|\z))/</span> <span class='or or kw'>or</span> <span class='return return kw'>return</span> <span class='string val'>&quot;&quot;</span>
  <span class='source_file identifier id'>source_file</span><span class='comma token'>,</span> <span class='source_line identifier id'>source_line</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
  <span class='returnf identifier id'>returnf</span> <span class='source_file identifier id'>source_file</span><span class='comma token'>,</span> <span class='source_line identifier id'>source_line</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="pass-instance_method">
  
    - (<tt>Object</tt>) <strong>pass</strong>(entry) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Handle test with pass status.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


97
98
99</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 97</span>

<span class='def def kw'>def</span> <span class='pass identifier id'>pass</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
  <span class='@passed ivar id'>@passed</span> <span class='lshft op'>&lt;&lt;</span> <span class='entry identifier id'>entry</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="skip-instance_method">
  
    - (<tt>Object</tt>) <strong>skip</strong>(entry) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Handle test with skip or pending status.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


117
118
119</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 117</span>

<span class='def def kw'>def</span> <span class='skip identifier id'>skip</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
  <span class='@skipped ivar id'>@skipped</span> <span class='lshft op'>&lt;&lt;</span> <span class='entry identifier id'>entry</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="source-instance_method">
  
    - (<tt>Object</tt>) <strong>source</strong>(file) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Cache source file text. This is only used if the TAP-Y stream doesn not
provide a snippet and the test file is locatable.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


242
243
244
245
246</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 242</span>

<span class='def def kw'>def</span> <span class='source identifier id'>source</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span>
  <span class='@source ivar id'>@source</span><span class='lbrack token'>[</span><span class='file identifier id'>file</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='lparen token'>(</span>
    <span class='File constant id'>File</span><span class='dot token'>.</span><span class='readlines identifier id'>readlines</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span>
  <span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="start_case-instance_method">
  
    - (<tt>Object</tt>) <strong>start_case</strong>(entry) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>At the start of a new test case.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


85
86</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 85</span>

<span class='def def kw'>def</span> <span class='start_case identifier id'>start_case</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="start_suite-instance_method">
  
    - (<tt>Object</tt>) <strong>start_suite</strong>(entry) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Handle header.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


81
82</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 81</span>

<span class='def def kw'>def</span> <span class='start_suite identifier id'>start_suite</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="tally-instance_method">
  
    - (<tt>Object</tt>) <strong>tally</strong>(entry) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>TODO: get the tally’s from the footer entry ?</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 130</span>

<span class='def def kw'>def</span> <span class='tally identifier id'>tally</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
  <span class='total identifier id'>total</span> <span class='assign token'>=</span> <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'count'</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='lparen token'>(</span><span class='@passed ivar id'>@passed</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='plus op'>+</span> <span class='@failed ivar id'>@failed</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='plus op'>+</span> <span class='@raised ivar id'>@raised</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span>

  <span class='if if kw'>if</span> <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'tally'</span><span class='rbrack token'>]</span>
    <span class='count_fail identifier id'>count_fail</span>  <span class='assign token'>=</span> <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'tally'</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>'fail'</span><span class='rbrack token'>]</span>  <span class='orop op'>||</span> <span class='integer val'>0</span>
    <span class='count_error identifier id'>count_error</span> <span class='assign token'>=</span> <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'tally'</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>'error'</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='integer val'>0</span>
  <span class='else else kw'>else</span>
    <span class='count_fail identifier id'>count_fail</span>  <span class='assign token'>=</span> <span class='@failed ivar id'>@failed</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
    <span class='count_error identifier id'>count_error</span> <span class='assign token'>=</span> <span class='@raised ivar id'>@raised</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='tally identifier id'>tally</span> <span class='assign token'>=</span> <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'tally'</span><span class='rbrack token'>]</span>
    <span class='sums identifier id'>sums</span> <span class='assign token'>=</span> <span class='dstring node'>%w{pass fail error skip}</span><span class='dot token'>.</span><span class='map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='e identifier id'>e</span><span class='bitor op'>|</span> <span class='tally identifier id'>tally</span><span class='lbrack token'>[</span><span class='e identifier id'>e</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='integer val'>0</span> <span class='rbrace token'>}</span>
  <span class='else else kw'>else</span>
    <span class='sums identifier id'>sums</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='@passed ivar id'>@passed</span><span class='comma token'>,</span> <span class='@failed ivar id'>@failed</span><span class='comma token'>,</span> <span class='@raised ivar id'>@raised</span><span class='comma token'>,</span> <span class='@skipped ivar id'>@skipped</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='e identifier id'>e</span><span class='bitor op'>|</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>

  <span class='assertions identifier id'>assertions</span> <span class='assign token'>=</span> <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'assertions'</span><span class='rbrack token'>]</span>
  <span class='failures identifier id'>failures</span>   <span class='assign token'>=</span> <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'failures'</span><span class='rbrack token'>]</span>

  <span class='if if kw'>if</span> <span class='assertions identifier id'>assertions</span>
    <span class='text identifier id'>text</span> <span class='assign token'>=</span> <span class='string val'>&quot;%s tests: %s pass, %s fail, %s err, %s pending (%s/%s assertions)&quot;</span>
    <span class='text identifier id'>text</span> <span class='assign token'>=</span> <span class='text identifier id'>text</span> <span class='mod op'>%</span> <span class='lbrack token'>[</span><span class='total identifier id'>total</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='sums identifier id'>sums</span><span class='rbrack token'>]</span> <span class='plus op'>+</span> <span class='lbrack token'>[</span><span class='assertions identifier id'>assertions</span> <span class='minus op'>-</span> <span class='failures identifier id'>failures</span><span class='comma token'>,</span> <span class='assertions identifier id'>assertions</span><span class='rbrack token'>]</span>
  <span class='else else kw'>else</span>
    <span class='text identifier id'>text</span> <span class='assign token'>=</span> <span class='string val'>&quot;%s tests: %s pass, %s fail, %s err, %s pending&quot;</span>
    <span class='text identifier id'>text</span> <span class='assign token'>=</span> <span class='text identifier id'>text</span> <span class='mod op'>%</span> <span class='lbrack token'>[</span><span class='total identifier id'>total</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='sums identifier id'>sums</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='count_fail identifier id'>count_fail</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>
    <span class='text identifier id'>text</span><span class='dot token'>.</span><span class='ansi identifier id'>ansi</span><span class='lparen token'>(</span><span class='symbol val'>:red</span><span class='rparen token'>)</span>
  <span class='elsif elsif kw'>elsif</span> <span class='count_error identifier id'>count_error</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>
    <span class='text identifier id'>text</span><span class='dot token'>.</span><span class='ansi identifier id'>ansi</span><span class='lparen token'>(</span><span class='symbol val'>:yellow</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='text identifier id'>text</span><span class='dot token'>.</span><span class='ansi identifier id'>ansi</span><span class='lparen token'>(</span><span class='symbol val'>:green</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="test-instance_method">
  
    - (<tt>Object</tt>) <strong>test</strong>(entry) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Handle test. This is run before the status handlers.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


93
94</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/tapout/reporters/abstract.rb', line 93</span>

<span class='def def kw'>def</span> <span class='test identifier id'>test</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Sat May 21 16:28:31 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.7 (ruby-1.8.7).
</div>

  </body>
</html>